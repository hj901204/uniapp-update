(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-415a99a1"],{1474:function(e,t,a){},"263c":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"department-management"},[e.treeData.length>0?a("Tree",{staticClass:"tree",attrs:{treeData:e.treeData},on:{handleGetNode:e.handleGetNode}}):e._e(),a("div",{staticClass:"table-box"},[a("div",{staticClass:"depart-btns"},[1==e.type?a("el-button",{attrs:{type:"danger",size:"small"},on:{click:e.handleDelete}},[e._v("删除")]):e._e(),1==e.type?a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.handleEdit}},[e._v("修改")]):e._e(),1==e.type?a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.handleAdd}},[e._v("添加")]):e._e()],1),a("Table",{attrs:{tableHead:e.tableHead,tableData:e.tableData,maxHeight:e.maxHeight,currentPage:e.currentPage,total:e.total,currentSize:e.currentSize},on:{sizeChange:e.sizeChange,currentChange:e.currentChange}})],1),e.dialogVisible?a("el-dialog",{attrs:{title:e.title,visible:e.dialogVisible,"close-on-click-modal":!1,width:"40%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-form",{ref:"ruleFormRef",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"部门名称",prop:"name",size:"small"}},[a("el-input",{model:{value:e.ruleForm.name,callback:function(t){e.$set(e.ruleForm,"name",t)},expression:"ruleForm.name"}})],1),a("el-form-item",{attrs:{label:"部门编码",prop:"code",size:"small"}},[a("el-input",{model:{value:e.ruleForm.code,callback:function(t){e.$set(e.ruleForm,"code",t)},expression:"ruleForm.code"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:e.handleCancel}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.handleSaveAdd}},[e._v("确 定")])],1)],1):e._e()],1)},n=[],r=(a("b0c0"),{name:"department-management",components:{Tree:function(e){return a.e("chunk-6b5577d3").then(function(){var t=[a("2bed")];e.apply(null,t)}.bind(this)).catch(a.oe)},Table:function(e){return a.e("chunk-412ae82e").then(function(){var t=[a("f4f7")];e.apply(null,t)}.bind(this)).catch(a.oe)}},computed:{resetForm:function(e){this.$refs[e].clearValidate()}},data:function(){return{type:this.$store.getters.type,ruleForm:{},title:"",rules:{name:[{required:!0,message:"请输入部门名称",trigger:"blur"}],code:[{required:!0,message:"请输入部门编码",trigger:"blur"}]},maxHeight:document.body.clientHeight-390,dialogVisible:!1,treeData:[],tableHead:[{fieldNo:"name",fieldName:"姓名",id:1},{fieldNo:"email",fieldName:"邮件",id:2,width:300}],tableData:[],currentPage:1,currentSize:10,total:0}},mounted:function(){this.getdepartTreeData()},methods:{handleGetNode:function(e,t){this.nodeId=e.id,this.nodeObj={id:e.id,parentId:e.parentId,name:e.name,code:e.code},this.getUserData(void 0,void 0,this.nodeId)},handleAdd:function(){if(this.ruleForm={},this.title="添加部门",this.treeData&&0!=this.treeData.length)if(1==this.treeData.length&&0==this.treeData[0].children.length)this.ruleForm.parentId=this.treeData[0].id,this.dialogVisible=!0;else{if(!this.nodeId&&0!=this.treeData[0].children.length)return this.$message({message:"请选择部门",type:"warning"});this.ruleForm.parentId=this.nodeId,this.dialogVisible=!0}else this.ruleForm.parentId="-1",this.dialogVisible=!0},handleSaveAdd:function(){var e=this;this.$refs.ruleFormRef.validate((function(t){if(!t)return!1;var a=e.ruleForm.id?"edit":"add";"add"==a?e.addDepartFunc(e.ruleForm):e.updateDepartFunc(e.ruleForm)}))},addDepartFunc:function(e){var t=this;this.$api.addData(this.$lesUiPath.depart,e).then((function(e){0==e.code?(t.dialogVisible=!1,t.nodeId="",t.getdepartTreeData()):t.$message.warning(e.msg)}))},updateDepartFunc:function(e){var t=this;this.$api.updateData(this.$lesUiPath.depart,e).then((function(e){0==e.code&&(t.dialogVisible=!1,t.nodeId="",t.getdepartTreeData())}))},handleEdit:function(){if(!this.nodeId)return this.$message.warning("请选择部门");this.title="修改部门",this.ruleForm=this.nodeObj,this.ruleForm.id&&(this.dialogVisible=!0)},handleDelete:function(){var e=this;if(!this.nodeId)return this.$message.warning("请选择要删除的部门");this.$confirm("此操作将永久删除, 是否继续?","提示",this.$global.confirmConfig).then((function(){e.$api.delData(e.$lesUiPath.depart,{id:e.nodeId}).then((function(t){if(0==t.code)return e.getdepartTreeData(),e.$message.success("删除成功")}))}))},handleCancel:function(){this.dialogVisible=!1,this.nodeId=""},getdepartTreeData:function(){var e=this;this.$api.post(this.$lesUiPath.departTree).then((function(t){0==t.code&&(e.treeData=t.data)}))},getUserData:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n={page:t,length:a,departId:i};this.$api.post(this.$lesUiPath.enteruserFindUserList,n).then((function(t){0==t.code?(e.tableData=t.data,e.total=e.tableData.length):e.$message.warning(t.msg)}))},sizeChange:function(e){this.currentSize=e,this.getUserData(this.currentPage,this.currentSize,this.nodeId)},currentChange:function(e){this.currentPage=e,this.getUserData(this.currentPage,this.currentSize,this.nodeId)}}}),s=r,l=(a("d107"),a("2877")),d=Object(l["a"])(s,i,n,!1,null,"8e3cf886",null);t["default"]=d.exports},d107:function(e,t,a){"use strict";var i=a("1474"),n=a.n(i);n.a}}]);